'From Pharo5.0 of 16 April 2015 [Latest update: #50761] on 25 October 2019 at 8:56:58.085477 am'!!SequenceableCollection methodsFor: '*UniquePermutations' stamp: 'BenoitStJean 10/25/2019 08:44'!uniquePermutationsStartingAt: anInteger do: aBlock	"Private"		anInteger > self size ifTrue: [^self].	anInteger = self size ifTrue: [^aBlock value: self].	anInteger to: self size do:		[:i |	(self shouldSwap: anInteger with: i)					ifTrue: [	self swap: anInteger with: i.								self uniquePermutationsStartingAt: anInteger + 1 do: aBlock.								self swap: anInteger with: i]].! !'From Pharo5.0 of 16 April 2015 [Latest update: #50761] on 25 October 2019 at 8:56:58.089477 am'!!SequenceableCollection methodsFor: '*UniquePermutations' stamp: 'BenoitStJean 10/25/2019 08:28'!uniquePermutationsDo: aBlock	"Repeatedly value aBlock with a single copy of the receiver. Reorder the copy	so that aBlock is presented ONLY UNIQUE permutations out of (self size factorial) 	possible permutations.		In comparison, the Array #(1 2 3 4 1 2) evaluates <aBlock> 720 times when used with 	#permutationsDo: as compared to only 180 when used with #uniquePermutationsDo: ."		"#(1 2 3 4 1 2) uniquePermutationsDo: [:each | Transcript cr; show: each printString]"	self shallowCopy uniquePermutationsStartingAt: 1 do: aBlock! !'From Pharo5.0 of 16 April 2015 [Latest update: #50761] on 25 October 2019 at 8:56:58.091477 am'!!SequenceableCollection methodsFor: '*UniquePermutations' stamp: 'BenoitStJean 10/25/2019 08:28'!shouldSwap: startIndex with: currentIndex	"Private"	"Answer <true> if the element at <currentIndex> does not matches any of the  	elements after <startIndex>" 	startIndex to: (currentIndex-1) do: [ :idx |	((self at: idx) = (self at: currentIndex)) 																	ifTrue: [ ^false ]].	^true! !